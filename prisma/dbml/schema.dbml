//// ------------------------------------------------------
//// THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
//// ------------------------------------------------------

Table user {
  id Int [pk, increment]
  created_at DateTime [default: `now()`, not null]
  updated_at DateTime [default: `now()`, not null]
  archived_at DateTime
  auth_id String [unique, not null]
  first_name String [not null]
  last_name String [not null]
  full_name String [not null]
  email String [unique, not null]
  avatar_url String
  active_workspace_id Int
  hubspot_contact_id String
  sentry_id String
  post_hog_id String
  phone String
  last_login_at DateTime
  onboarding_step onboarding_step [default: 'PERSONAL_INFO']
  onboarding_completed_at DateTime
  active_workspace workspace
  workspaces user_workspace [not null]
  actions action [not null]
}

Table workspace {
  id Int [pk, increment]
  created_at DateTime [default: `now()`, not null]
  updated_at DateTime [default: `now()`, not null]
  archived_at DateTime
  name String [not null]
  slug String [unique]
  team_tags String[] [not null]
  icon_url String
  background_colour String
  linear_customer_id String
  stripe_customer_id String
  hubspot_company_id String
  subscription_id Int [unique]
  subscription subscription
  billing_infos workspace_billing_infos [not null]
  user_workspaces user_workspace [not null]
  active_users user [not null]
  folders folder [not null]
  workflows workflow [not null]
  billings billing [not null]
}

Table workspace_billing_infos {
  id Int [pk, increment]
  created_at DateTime [default: `now()`, not null]
  updated_at DateTime [default: `now()`, not null]
  billing_email String [not null]
  billing_address String [not null]
  tax_rate Decimal [not null]
  vat_number String
  workspace_id Int [not null]
  workspace workspace [not null]
}

Table subscription {
  id Int [pk, increment]
  created_at DateTime [default: `now()`, not null]
  updated_at DateTime [default: `now()`, not null]
  canceled_at DateTime
  workspace_id Int [unique, not null]
  stripe_subscription_id String [not null]
  trial_end_date DateTime
  plan_type plan_type [not null]
  quantity_seats Int [not null]
  current_period_start DateTime [not null]
  current_period_end DateTime [not null]
  status subscription_status [not null]
  workspace workspace
  billings billing [not null]
}

Table billing {
  id Int [pk, increment]
  created_at DateTime [default: `now()`, not null]
  updated_at DateTime [default: `now()`, not null]
  paid_at DateTime
  subscription_id Int [not null]
  stripe_invoice_id String [unique, not null]
  amount_net Int [not null]
  tax_amount Int [not null]
  amount_gross Int [not null]
  currency String [not null]
  invoice_date DateTime [not null]
  due_date DateTime [not null]
  workspace_id Int [not null]
  subscription subscription [not null]
  workspace workspace [not null]
}

Table user_workspace {
  id Int [pk, increment]
  user_id Int [not null]
  workspace_id Int [not null]
  role user_role [not null, default: 'ADMIN']
  user user [not null]
  workspace workspace [not null]
}

Table folder {
  id Int [pk, increment]
  name String [not null]
  workspace_id Int [not null]
  parent_id Int
  icon_url String
  emote String
  team_tags String[] [not null]
  path String
  workspace workspace [not null]
  parent folder
  subfolders folder [not null]
  workflows workflow [not null]
}

Table workflow {
  id Int [pk, increment]
  created_at DateTime [default: `now()`, not null]
  updated_at DateTime [default: `now()`, not null]
  last_opened DateTime
  name String [not null]
  description String [not null]
  workspace_id Int [not null]
  team_tags String[] [not null]
  folder_id Int
  workspace workspace [not null]
  folder folder
  blocks block [not null]
  paths path [not null]
  actions action [not null]

  indexes {
    (name, workspace_id) [unique]
  }
}

Table path {
  id Int [pk, increment]
  name String [not null]
  workflow_id Int [not null]
  workflow workflow [not null]
  blocks block [not null]
  parent_blocks path_parent_block [not null]

  Note: 'Collection of connected blocks forming a workflow path'
}

Table path_parent_block {
  path_id Int [not null]
  block_id Int [not null]
  created_at DateTime [default: `now()`, not null]
  path path [not null]
  block block [not null]

  indexes {
    (path_id, block_id) [pk]
  }

  Note: 'Junction table that allows paths to be triggered from multiple parent blocks'
}

Table block {
  id Int [pk, increment]
  created_at DateTime [default: `now()`, not null]
  updated_at DateTime [default: `now()`, not null]
  last_modified DateTime
  type block_type [not null]
  step_details String
  delay_seconds Int
  position Int [not null]
  title String
  icon String
  description String
  image String
  image_description String
  average_time String
  task_type task_type
  workflow_id Int [not null]
  path_id Int [not null]
  click_position Json
  workflow workflow [not null]
  path path [not null]
  actions action [not null]
  child_paths path_parent_block [not null]
}

Table action {
  id Int [pk, increment]
  user_id Int [not null]
  type String [not null]
  target_id Int [not null]
  workflow_id Int [not null]
  value Int [not null]
  created_at DateTime [default: `now()`, not null]
  user user [not null]
  target block [not null]
  workflow workflow [not null]
}

Enum onboarding_step {
  PERSONAL_INFO
  PROFESSIONAL_INFO
  WORKSPACE_SETUP
  COMPLETED
}

Enum user_role {
  ADMIN
  EDITOR
  READER
}

Enum block_type {
  DELAY
  STEP
  PATH
}

Enum subscription_status {
  ACTIVE
  TRIALING
  CANCELED
}

Enum plan_type {
  FREE
  STARTER
  PROFESSIONAL
  ENTERPRISE
}

Enum task_type {
  MANUAL
  AUTOMATIC
}

Ref: user.active_workspace_id > workspace.id

Ref: workspace.subscription_id - subscription.id

Ref: workspace_billing_infos.workspace_id > workspace.id

Ref: billing.subscription_id > subscription.id

Ref: billing.workspace_id > workspace.id

Ref: user_workspace.user_id > user.id

Ref: user_workspace.workspace_id > workspace.id

Ref: folder.workspace_id > workspace.id

Ref: folder.parent_id - folder.id

Ref: workflow.workspace_id > workspace.id

Ref: workflow.folder_id > folder.id

Ref: path.workflow_id > workflow.id

Ref: path_parent_block.path_id > path.id [delete: Cascade]

Ref: path_parent_block.block_id > block.id [delete: Cascade]

Ref: block.workflow_id > workflow.id [delete: Cascade]

Ref: block.path_id > path.id [delete: Cascade]

Ref: action.user_id > user.id

Ref: action.target_id > block.id

Ref: action.workflow_id > workflow.id